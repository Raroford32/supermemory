/**
 * Exploit Research Memory System
 *
 * This module provides tools for storing, retrieving, deduplicating,
 * and routing feedback for autonomous exploit research systems.
 */

// Reducers - Transform verbose outputs into compact summaries
export {
	reduceSourceCode,
	reduceABI,
	reduceGraph,
	reduceInvariants,
	reducePath,
	reduceForgeLogs,
	reduceAddressList,
	reduceGeneric,
	reduceByKind,
	reducers,
	type ReducerResult,
} from "./reducers"

// Dedup - Detect duplicates and calculate novelty
export {
	cosineSimilarity,
	checkDuplicate,
	calculateNoveltyScore,
	filterDuplicates,
	findMostSimilar,
	batchSimilarityCheck,
	calculateDiversity,
	dedup,
	type DedupResult,
	type DedupConfig,
	type EmbeddingEntry,
} from "./dedup"

// Middleware - Intercept tool calls and store to Supermemory
export {
	createExploitResearchMiddleware,
	middleware,
	type ToolCallContext,
	type MiddlewareConfig,
	type SeasonStatus,
	type RetrieveResult,
	type ExploitResearchMiddleware,
} from "./middleware"

// Security - Secret redaction and sensitive content handling
export {
	redactSecrets,
	containsSecrets,
	checkSensitivity,
	sanitizeContent,
	processArtifactForSecurity,
	security,
	type RedactionResult,
	type SensitiveContentType,
	type SensitivityCheck,
	type SanitizeOptions,
	type SanitizeResult,
	type ArtifactSecurityMetadata,
} from "./security"

// Metrics - Track tokens, retrieval, dedup, execution
export {
	createMetricsCollector,
	MetricsCollector,
	metrics,
	type TokenMetrics,
	type RetrievalMetrics,
	type DedupMetrics,
	type PhaseMetrics,
	type ExecutionMetrics,
	type SeasonMetrics,
} from "./metrics"
